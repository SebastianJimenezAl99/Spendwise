<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spendwise - Dashboard</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="lang.js"></script>
  <script src="functions.js"></script>
  <script src="controller_dashboard.js" defer></script>

  <link rel="stylesheet" href="styles.css">
</head>

<body onload="applyLanguage()" class="bg-light">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-success shadow-sm sticky-top">
  <div class="container-fluid px-4">
    <a class="navbar-brand d-flex align-items-center" href="dashboard.html">
      <img src="assets/logo.jpeg" alt="Logo" class="rounded-circle me-2" width="45" height="45">
      <span class="fw-bold fs-4">Spendwise</span>
    </a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto align-items-center">
        <li class="nav-item me-3">
          <select id="langSelectDashboard" onchange="SpendwiseLang.setLang(this.value)" class="form-select form-select-sm bg-light" aria-label="Language selector">
            <option value="en">üåê English</option>
            <option value="es">üåê Espa√±ol</option>
          </select>
        </li>
        <li class="nav-item">
          <button id="btnLogout" class="btn btn-light btn-sm" data-i18n="logout">
            <i class="bi bi-box-arrow-right me-1"></i>Logout
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<main class="container my-4">

  <!-- Welcome Card -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card border-0 shadow-sm bg-gradient-success text-white">
        <div class="card-body p-4">
          <div class="d-flex align-items-center justify-content-between">
            <div>
              <h2 id="welcomeTitle" class="fw-bold mb-2" data-i18n="welcome">Welcome</h2>
              <p class="mb-0 fs-5">
                <span data-i18n="balance">Balance</span>:
                <strong id="balanceValue" class="fs-3">$0.00</strong>
              </p>
            </div>
            <div class="bg-white bg-opacity-25 rounded-circle d-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
              <i class="bi bi-wallet2 fs-1"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chart and Form Row -->
  <div class="row g-4 mb-4">
    <!-- Chart Card -->
    <div class="col-lg-8">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title fw-bold text-success mb-3">
            <i class="bi bi-graph-up me-2"></i>Financial Overview
          </h5>
          <canvas id="chart"></canvas>
        </div>
      </div>
    </div>

    <!-- Add Transaction Card -->
    <div class="col-lg-4">
      <div class="card border-0 shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title fw-bold text-success mb-4" data-i18n="addTx">
            <i class="bi bi-plus-circle me-2"></i>Add Transaction
          </h5>

          <form id="transForm">
            <div class="mb-3">
              <label class="form-label fw-semibold" data-i18n="type">Type</label>
              <select id="transType" class="form-select border-success border-opacity-25">
                <option value="income" data-i18n="income">Income</option>
                <option value="expense" data-i18n="expense">Expense</option>
              </select>
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold" data-i18n="amount">Amount</label>
              <div class="input-group">
                <span class="input-group-text bg-success bg-opacity-10 border-success border-opacity-25">
                  <i class="bi bi-currency-dollar text-success"></i>
                </span>
                <input id="transAmount" type="number" class="form-control border-success border-opacity-25" placeholder="" data-i18n-placeholder="amount_ph" step="0.01">
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label fw-semibold" data-i18n="description">Description</label>
              <input id="transDesc" class="form-control border-success border-opacity-25" placeholder="" data-i18n-placeholder="description_ph">
            </div>

            <button class="btn btn-success w-100 fw-semibold" type="submit" data-i18n="add">
              <i class="bi bi-check-circle me-2"></i>Add
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- History Card -->
  <div class="row">
    <div class="col-12">
      <div class="card border-0 shadow-sm">
        <div class="card-body">
          <h5 class="card-title fw-bold text-success mb-4" data-i18n="history">
            <i class="bi bi-clock-history me-2"></i>Transaction History
          </h5>

          <div class="table-responsive">
            <table id="txTable" class="table table-hover align-middle">
              <thead class="table-success">
                <tr>
                  <th data-i18n="date"><i class="bi bi-calendar3 me-2"></i>Date</th>
                  <th data-i18n="type"><i class="bi bi-tag me-2"></i>Type</th>
                  <th data-i18n="amount"><i class="bi bi-cash me-2"></i>Amount</th>
                  <th data-i18n="description"><i class="bi bi-file-text me-2"></i>Description</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- Footer -->
<footer class="bg-dark text-white py-3 mt-5">
  <div class="container text-center">
    <p class="mb-0">&copy; 2025 Spendwise. All rights reserved.</p>
  </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Ensure the dashboard language select reflects stored language and updates the UI
  (function(){
    try{
      const sel = document.getElementById('langSelectDashboard');
      if(!sel) return;
      // Set saved value
      sel.value = SpendwiseLang.getLang();
      // Ensure change updates all texts (setLang already calls applyLanguage)
      sel.addEventListener('change', e => {
        SpendwiseLang.setLang(e.target.value);
      });
    }catch(e){ console.warn('Language init error', e); }
  })();
</script>

</body>
</html>

